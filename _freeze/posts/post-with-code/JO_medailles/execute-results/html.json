{
  "hash": "5f244d3609b684ac865725ac894dc9f8",
  "result": {
    "markdown": "---\ntitle: \"Les jeux olympiques : médailles des athlètes\"\nauthor: \"Cassandre Orhan\"\ndate: \"2024-03-09\"\n---\n\n\nL'objectif de ce rapport est d'analyser les performances des athlètes aux Jeux Olympiques en termes d'éditions et de médailles remportées. Cette analyse nous permettra de comprendre les tendances historiques en matière de succès sportifs et d'identifier les pays dominants dans l'histoire des Jeux Olympiques.\n\n## Librairie\n\nDans le cadre de ce rapport, nous nous appuierons sur des bibliothèques disponibles dans le CRAN.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(rvest)\nlibrary(purrr)\nlibrary(stringr)\nlibrary(tibble)\n```\n:::\n\n\n## Préparation de la base de données\n\nNous avons dans un premier temps importé notre base de données :\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlist_tables <-\n  session(\n    \"https://fr.wikipedia.org/wiki/Liste_des_m%C3%A9daill%C3%A9s_olympiques\")|> \n  html_elements(\".wikitable\") |>\n  html_table()\n```\n:::\n\n\nL'objet `list_tables` contient les données de toutes les tables HTML de classe \"wikitable\" trouvées sur la page Wikipedia spécifiée. Dans ce cas, il contient la liste des médaillés olympiques selon six tables distinctes :\n\n-   Sports des Jeux Olympiques d'été\n\n-   Sports des Jeux Olympiques d'hiver\n\n-   Anciens sports d'été\n\n-   Anciens sports d'hiver\n\n-   Par édition, Jeux Olympiques d'été\n\n-   Par édition, Jeux Olympiques d'hiver\n\nCes différentes tables contiennent des informations sur les médailles olympiques attribuées aux athlètes dans différentes disciplines et éditions des Jeux Olympiques,\n\n## Médaillés des jeux olympiques d'été\n\nLa première étape de cet exercice consistait à préparer la base de données en supprimant les lignes et les colonnes inutiles, ainsi qu'en renommant les colonnes et les lignes pour plus de lisibilité. Cette étape est essentielle pour assurer que les données sont bien organisées et faciles à analyser par la suite. En nettoyant la base de données et en la structurant de manière claire, nous pouvons faciliter les étapes d'analyse et d'interprétation des données\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsport_ete <- data.frame(list_tables[1])\n\nsport_ete <- sport_ete[-1,-1]\n\nnames(sport_ete)<-c(\"Discipline\", \"Annees\", \"Editions\", \"Epreuves_2020\", \"Or\", \"Argent\", \"Bronze\", \"Total\", \"Athletes_medailles\", \"Athletes_or\")\n\nsport_ete[c(\"Editions\", \"Epreuves_2020\", \"Or\", \"Argent\", \"Bronze\", \"Total\")] <- lapply(sport_ete[c(\"Editions\", \"Epreuves_2020\", \"Or\", \"Argent\", \"Bronze\", \"Total\")], as.integer)\n\nsport_ete$Athletes_or <- ifelse(sport_ete$Athletes_or == \"17 athlètes avec 1 médaille d'or\", \"Chandler Egan (USA) (1-1-0)\", sport_ete$Athletes_or)\nsport_ete$Athletes_or [c(30)] <- \"Dezső Gyarmati (HUN) (3-1-1)\"\n\nstr(sport_ete)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n'data.frame':\t30 obs. of  10 variables:\n $ Discipline        : chr  \"Athlétisme\" \"Aviron\" \"Badminton\" \"Basket-ball\" ...\n $ Annees            : chr  \"Depuis 1896\" \"Depuis 1900\" \"Depuis 1992\" \"Depuis 1936\" ...\n $ Editions          : int  29 28 8 20 26 20 29 26 29 27 ...\n $ Epreuves_2020     : int  48 14 5 4 13 16 22 6 12 2 ...\n $ Or                : int  1028 269 39 32 266 242 263 151 223 34 ...\n $ Argent            : int  1030 268 39 32 266 241 261 149 223 34 ...\n $ Bronze            : int  1027 273 43 32 472 243 260 148 221 35 ...\n $ Total             : int  3085 810 121 96 1004 726 784 448 667 103 ...\n $ Athletes_medailles: chr  \"Paavo Nurmi (FIN) (9-3-0)\" \"Elisabeta Lipă (ROU) (5-2-1)\" \"Gao Ling (CHN) (2-1-1)\" \"Teresa Edwards (USA) (4-0-1)\" ...\n $ Athletes_or       : chr  \"Paavo Nurmi (FIN) (9-3-0) Carl Lewis (USA) (9-1-0)\" \"Elisabeta Lipă (ROU) (5-2-1) Georgeta Damian (ROU) (5-0-1) Steven Redgrave (GBR) (5-0-1)\" \"Gao Ling (CHN) (2-1-1) Kim Dong-moon (KOR) (2-0-1) Zhang Nan (CHN) (2-0-1) Ge Fei (CHN) (2-0-0) Gu Jun (CHN) (2\"| __truncated__ \"Teresa Edwards (USA) (4-0-1) Sue Bird (USA) (4-0-0) Tamika Catchings (USA) (4-0-0) Lisa Leslie (USA) (4-0-0) Di\"| __truncated__ ...\n```\n:::\n\n```{.r .cell-code}\ndim(sport_ete)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 30 10\n```\n:::\n\n```{.r .cell-code}\nknitr::kable(head(sport_ete))\n```\n\n::: {.cell-output-display}\n|   |Discipline  |Annees                 | Editions| Epreuves_2020|   Or| Argent| Bronze| Total|Athletes_medailles                                                                                                                                                                                                                                                                                      |Athletes_or                                                                                                                                                                                                           |\n|:--|:-----------|:----------------------|--------:|-------------:|----:|------:|------:|-----:|:-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n|2  |Athlétisme  |Depuis 1896            |       29|            48| 1028|   1030|   1027|  3085|Paavo Nurmi (FIN) (9-3-0)                                                                                                                                                                                                                                                                               |Paavo Nurmi (FIN) (9-3-0) Carl Lewis (USA) (9-1-0)                                                                                                                                                                    |\n|3  |Aviron      |Depuis 1900            |       28|            14|  269|    268|    273|   810|Elisabeta Lipă (ROU) (5-2-1)                                                                                                                                                                                                                                                                            |Elisabeta Lipă (ROU) (5-2-1) Georgeta Damian (ROU) (5-0-1) Steven Redgrave (GBR) (5-0-1)                                                                                                                              |\n|4  |Badminton   |Depuis 1992            |        8|             5|   39|     39|     43|   121|Gao Ling (CHN) (2-1-1)                                                                                                                                                                                                                                                                                  |Gao Ling (CHN) (2-1-1) Kim Dong-moon (KOR) (2-0-1) Zhang Nan (CHN) (2-0-1) Ge Fei (CHN) (2-0-0) Gu Jun (CHN) (2-0-0) Lin Dan (CHN) (2-0-0) Zhang Jun (CHN) (2-0-0) Zhang Ning (CHN) (2-0-0) Zhao Yunlei (CHN) (2-0-0) |\n|5  |Basket-ball |Depuis 1936            |       20|             4|   32|     32|     32|    96|Teresa Edwards (USA) (4-0-1)                                                                                                                                                                                                                                                                            |Teresa Edwards (USA) (4-0-1) Sue Bird (USA) (4-0-0) Tamika Catchings (USA) (4-0-0) Lisa Leslie (USA) (4-0-0) Diana Taurasi (USA) (4-0-0)                                                                              |\n|6  |Boxe        |1904, 1908,depuis 1920 |       26|            13|  266|    266|    472|  1004|László Papp (HUN) (3-0-0) Félix Savón (CUB) (3-0-0) Teófilo Stevenson (CUB) (3-0-0) Roniel Iglesias (CUB) (2-0-1) Boris Lagutin (URS) (2-0-1) Oleg Saitov (RUS) (2-0-1) Zou Shiming (CHN) (2-0-1) Roberto Cammarelle (ITA) (1-1-1) Zbigniew Pietrzykowski (POL) (0-1-2) Arnold Vanderlyde (NED) (0-0-3) |László Papp (HUN) (3-0-0) Félix Savón (CUB) (3-0-0) Teófilo Stevenson (CUB) (3-0-0)                                                                                                                                   |\n|7  |Canoë-kayak |Depuis 1936            |       20|            16|  242|    241|    243|   726|Birgit Fischer (GER) (8-4-0)                                                                                                                                                                                                                                                                            |Birgit Fischer (GER) (8-4-0)                                                                                                                                                                                          |\n:::\n:::\n\n\nCette base de données, référençant les médaillés pour les Jeux Olympiques d'été, est composée de 10 colonnes et 30 lignes. Les colonnes sont :\n\n-   Les disciplines pratiquées,\n\n-   Des informations sur leurs années d'édition, depuis quand ? Est ce qu'il y a eu des coupures ?\n\n-   Le nombre d'éditions,\n\n-   Le nombre d'épreuves durant la dernière édition correspondant à 2020,\n\n-   Le nombre de médailles d'or, d'argent et de bronze ainsi que le total de médailles,\n\n-   Les athlètes médaillés ainsi que les athlètes ayant obtenu au moins une médaille d'or.\n\n## Disciplines avec le plus de médailles distribués\n\nL'objectif de ce code est de déterminer le top 3 des disciplines avec le plus grand nombre de médailles distribuées aux Jeux Olympiques. Pour ce faire, nous commençons par trier la colonne contenant le nombre total de médailles dans un ordre croissant. Ensuite, nous sélectionnons les trois disciplines les plus pertinentes pour notre analyse.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmax_tt<-max(sport_ete$Total)\ntop_3 <- head(sport_ete[order(sport_ete$Total, decreasing = TRUE), ], 3)\nknitr::kable(top_3[c(1,8)])\n```\n\n::: {.cell-output-display}\n|   |Discipline               | Total|\n|:--|:------------------------|-----:|\n|2  |Athlétisme               |  3085|\n|19 |Natation(hommes, femmes) |  1814|\n|18 |Lutte                    |  1358|\n:::\n:::\n\n\nNous constatons ainsi que les disciplines avec le plus grand nombre de médailles distribuées sont l'athlétisme, la natation et la lutte.\n\n## Disciplines avec le moins de d'épreuve en 2020\n\nL'objectif de ce code est de trier les disciplines en fonction du nombre d'épreuves le moins élevé lors des Jeux Olympiques de 2020, on effectue un trie dans un ordre décroissant. En effectuant ce tri, nous pouvons identifier les disciplines qui ont eu moins de représentation ou de diversité d'épreuves lors de la dernière édition des Jeux Olympiques\n\n\n::: {.cell}\n\n```{.r .cell-code}\nepreuves_2020<-head(sport_ete[order(sport_ete$Epreuves_2020,decreasing=FALSE),])\nknitr::kable(epreuves_2020[c(1,4)])\n```\n\n::: {.cell-output-display}\n|   |Discipline            | Epreuves_2020|\n|:--|:---------------------|-------------:|\n|11 |Football              |             2|\n|12 |Golf                  |             2|\n|14 |Handball              |             2|\n|16 |Hockey sur gazon      |             2|\n|20 |Natation synchronisée |             2|\n|21 |Pentathlon moderne    |             2|\n:::\n:::\n\n\nAinsi, parmi les disciplines ayant été les moins représentées lors de l'édition des Jeux Olympiques de 2020, on retrouve notamment le football et le golf.\n\n## Fonction calcul_nb_edition.int\n\nLe but de cette fonction est de calculer le nombre d'éditions auxquelles une épreuve a été présente aux Jeux Olympiques pour les années données. Pour ce faire, la fonction effectue les étapes suivantes :\n\n-   Soustrait l'année donnée de 2020.\n\n-   Divise le résultat par la fréquence des Jeux Olympiques, qui correspond à 4 car les Jeux ont lieu tous les quatre ans.\n\n-   Ajoute une édition supplémentaire pour l'édition 2020.\n\n-   Tient compte des éditions qui n'ont pas eu lieu, notamment en raison des guerres mondiales.\n\nCette fonction ne prend en compte que des caractères numériques en entrée.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncalcul_nb_editions.int <- function(depuis) {\n \n  editions <- (((2020-depuis) / 4) +1)\n  \n  if (depuis <= 1916) {\n    editions <- editions - 3\n  } else if (depuis <= 1940){\n        editions <- editions - 2}\n      else if (depuis <= 1944){ \n        editions <- editions - 1}\n  \n  return(editions)\n}\n\ncalcul_nb_editions.int(1920)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 24\n```\n:::\n:::\n\n\nDonc, pour une épreuve présente depuis 1920, la fonction dénombrera 24 éditions au total.\n\n## Fonction calcul_nb_edition.str\n\nOn a repris la fonction qui permet de calculer le nombre d'édition mais on l'adapte maintenant au chaîne de caractère. La fonction prend donc en compte trois possibilités pour les chaînes de caractères représentant les années :\n\n-   Si l'année indiquée est de la forme \"1904-1924\", alors la fonction soustrait 1904 de 1924, divise le résultat par la fréquence des Jeux Olympiques, et ajoute \"+1\" pour l'année 1924.\n\n-   Si l'année indiquée est de la forme \"depuis 1904\" (ou \"Depuis\"), la fonction fonctionnera de la même manière que pour le calcul standard du nombre d'éditions.\n\n-   Si l'année indiquée est unique, la fonction comptera simplement une édition supplémentaire.\n\nCette fonction continue de prendre en compte les années où les Jeux Olympiques n'ont pas eu lieu en raison des guerres mondiales, afin de fournir un calcul précis du nombre d'éditions pour une épreuve donnée.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncalcul_nb_editions.str <- function(annees) {\n \n  annees <- gsub(\"\\\\s+\", \"\", annees)\n  years <- unlist(strsplit(annees, \",\"))\n\n \n  nb_editions <- 0\n\n  \n  for (annee in years) {\n    if (grepl(\"-\", annee)) {\n      range <- as.numeric(unlist(strsplit(annee, \"-\")))\n      nb_editions <- nb_editions + (((range[2] - range[1]) %/% 4 )+1)\n      \n     \n      if (range[2] >= 1944) nb_editions <- nb_editions - 3\n      else if (range[2] >= 1940) nb_editions <- nb_editions - 2\n      else if (range[2] >= 1916) nb_editions <- nb_editions - 1\n    } \n    \n    else if (grepl(\"depuis\", tolower(annee))) {\n      debut <- as.numeric(gsub(\"[^0-9]\", \"\", annee))\n      nb_editions <- nb_editions + ((2024 - debut) %/% 4)\n    \n      if (debut <= 1916) nb_editions <- nb_editions - 3\n      else if (debut <= 1940) nb_editions <- nb_editions - 2\n      else if (debut <= 1944) nb_editions <- nb_editions - 1\n    } else {\n      \n     \n      nb_editions <- nb_editions + 1\n    }\n  }\n\n  return(nb_editions)\n}\nnb_editions <-calcul_nb_editions.str(\"1896, 1904, depuis 1920\")\nnb_editions\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 26\n```\n:::\n:::\n\n\nPar exemple, si l'on indique qu'une discipline a été présente aux JO en 1896, 1904 et depuis 1920, alors la fonction a compté 2 dates uniques et ajouté le nombre d'éditions calculé avec \"depuis 1920\". Ici, la fonction nous retourne 26 éditions.\n\n## Fonction calcul_nb_edition\n\nNotre fonction permet donc de calculer le nombre d'éditions auxquelles une discipline est présente aux JO, que l'on renseigne une année précise ou une chaîne de caractères.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncalcul_nb_editions <- function(x) {\n  if(is.character(x)) {\n    calcul_nb_editions.str(x)\n  } else if(is.numeric(x)) {\n    calcul_nb_editions.int(x)\n  }\n}\n\ncalcul_nb_editions(\"1904-1924, depuis 1948\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 24\n```\n:::\n\n```{.r .cell-code}\ncalcul_nb_editions(2000)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 6\n```\n:::\n:::\n\n\nAinsi, la fonction nous retourne 24 éditions pour la chaîne de caractère \"1904-1924, depuis 1948\" et 6 éditions pour l'année 2000.\n\n## Fonction calcul_medailles_individuelles\n\nL'objectif de cette fonction est de fournir le nombre maximal de médailles obtenues par un athlète lors des olympiades dans une même cellule. Cette fonction prend en compte la possibilité que plusieurs athlètes puissent être mentionnés et permet ainsi de les distinguer. Elle identifie le nombre maximal de médailles attribuées à un seul athlète au sein d'une cellule donnée, offrant ainsi une analyse claire et précise des performances individuelles aux Jeux Olympiques.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncalcul_medailles_individuelles <- function(data){ \n  athletes <- unlist(str_split(data,\"\\\\)\\\\s\",simplify=TRUE))\n  resultats <- numeric(length(athletes))\n  \n  for (i in seq_along(athletes)){\n    medailles <- str_extract_all(athletes[i],\"\\\\d+\")\n    \n    if (length(medailles[[1]])>0){\n      chiffres<- as.integer(medailles[[1]])\n      resultats[i] <-sum(chiffres)\n    }\n  }\n  \nreturn(resultats[resultats !=0])\n\n}\n\ncalcul_medailles_individuelles(c(\"Larissa Latynina (URS) (9-5-4)\", \"Teddy Riner (FRA) (3-0-2) Ryōko Tani (JPN) (2-2-1)\",\"Elisabeta Lipă (ROU) (5-2-1)\",\"\t\nIsabell Werth (GER) (7-5-0)\",\"Ana Fernández (CUB) (3-0-1) Kerri Walsh (USA) (3-0-1) Inna Ryskal (URS) (2-2-0) Sérgio Dutra Santos (BRA) (2-2-0) Sergey Tetyukhin (RUS) (1-1-2)\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] 18  5  8 12  4  5  4  4  4  4\n```\n:::\n:::\n\n\nAinsi, Larissa Latynina a reçu 18 médailles, Teddy Riner en a reçu 5, etc.\n\nÀ présent, nous souhaitons identifier les 3 athlètes ayant reçu le plus de médailles en appliquant la fonction précédemment créée à toute la colonne \"Athletes_medailles\". Cela nous permettra de déterminer le nombre de médailles reçues par chacun des athlètes, facilitant ainsi l'identification des trois athlètes les plus médaillés.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nresultats_medailles_ete <- lapply(sport_ete$Athletes_medailles,calcul_medailles_individuelles)\nhead(resultats_medailles_ete)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[[1]]\n[1] 12\n\n[[2]]\n[1] 8\n\n[[3]]\n[1] 4\n\n[[4]]\n[1] 5\n\n[[5]]\n [1] 3 3 3 3 3 3 3 3 3 3\n\n[[6]]\n[1] 12\n```\n:::\n:::\n\n\nNous pouvons donc à présent déterminer les athlètes ayant reçu le plus de médailles. Pour cela, nous utilisons un code qui parcourt les résultats des médailles d'été pour chaque sport, extrait les noms des athlètes et le nombre de médailles correspondantes, puis les stocke dans un tibble. Enfin, il rassemble tous les résultats dans une liste, les combine en un seul tibble et identifie les trois athlètes avec le plus grand nombre de médailles d'été.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlist_medaille_ete <- list()\n\nfor (i in seq_along(resultats_medailles_ete)) {\n  matches <- str_match_all(sport_ete$Athletes_medailles[i],\"([^\\\\(]+\\\\s\\\\([^\\\\)]+\\\\))\\\\s*\\\\((\\\\d+)-(\\\\d+)-(\\\\d+)\\\\)\")\n  \n  df<- tibble(\n    Athlete = trimws(matches[[1]][,1]),\n    Medailles=resultats_medailles_ete[[i]]\n)\n  list_medaille_ete[[i]]<-df\n}\n\ntop_medailles_ete<-do.call(rbind,list_medaille_ete)\nknitr::kable(head(top_medailles_ete))\n```\n\n::: {.cell-output-display}\n|Athlete                      | Medailles|\n|:----------------------------|---------:|\n|Paavo Nurmi (FIN) (9-3-0)    |        12|\n|Elisabeta Lipă (ROU) (5-2-1) |         8|\n|Gao Ling (CHN) (2-1-1)       |         4|\n|Teresa Edwards (USA) (4-0-1) |         5|\n|László Papp (HUN) (3-0-0)    |         3|\n|Félix Savón (CUB) (3-0-0)    |         3|\n:::\n\n```{.r .cell-code}\ntop_3_medailles_ete <- head(top_medailles_ete[order(top_medailles_ete$Medailles, decreasing = TRUE), ], 3)\nknitr::kable(top_3_medailles_ete)\n```\n\n::: {.cell-output-display}\n|Athlete                           | Medailles|\n|:---------------------------------|---------:|\n|Michael Phelps (USA) (23-3-2)     |        28|\n|Larissa Latynina (URS) (9-5-4)    |        18|\n|Edoardo Mangiarotti (ITA) (6-5-2) |        13|\n:::\n:::\n\n\nAinsi, nous apprenons que les athlètes ayant reçu le plus de médailles sont Michael Phelps avec 28 médailles, suivi de Larissa Latynina avec 18 médailles à la deuxième place, et pour terminer Edoardo Mangiarotti avec 13 médailles.\n\n## Fonction extraire_nationalite_athlete\n\nLe but de cette fonction est d'extraire la nationalité des athlètes afin d'analyser la présence des différentes nationalités. Pour cela,on utilise des expressions régulières pour extraire les segments entre parenthèses représentant les nationalités des athlètes, puis on compte le nombre d'occurrences de chaque nationalité et on retourne le résultat.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nextraire_nationalite_athlete <- function(chaine) {\n  segments <- unlist(str_extract_all(chaine, \"\\\\([^\\\\)]+\\\\)\"))\n  nationalites <- character(length = length(segments))\n  \n  for (i in seq_along(segments)) {\n    matches <- str_match(segments[i], \"\\\\((\\\\w{3})\\\\)$\")\n    if (!is.na(matches[2])) {\n      nationalites[i] <- matches[2]\n    }\n  }\n  \n  counts <- table(nationalites)\n  \n  return(counts)\n}\n\nknitr::kable(extraire_nationalite_athlete(c(\"László Papp (HUN) (3-0-0) Félix Savón (CUB) (3-0-0) Teófilo Stevenson (CUB) (3-0-0)\",\"Aladár Gerevich (HUN) (7-1-2)\n\",\"Christie Rampone (USA) (3-1-0) Shannon Boxx (USA) (3-0-0) Heather Mitts (USA) (3-0-0) Heather O'Reilly (USA) (3-0-0)\n\")))\n```\n\n::: {.cell-output-display}\n|nationalites | Freq|\n|:------------|----:|\n|             |    8|\n|CUB          |    2|\n|HUN          |    2|\n|USA          |    4|\n:::\n:::\n\n\nAvant de déterminer quelles nationalités sont les plus présentes, nous devons appliquer la fonction à l'ensemble de notre jeu de données.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nresultat_nationalite_ete <- lapply(sport_ete$Athletes_or,extraire_nationalite_athlete)\nhead(resultat_nationalite_ete)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[[1]]\nnationalites\n    FIN USA \n  2   1   1 \n\n[[2]]\nnationalites\n    GBR ROU \n  3   1   2 \n\n[[3]]\nnationalites\n    CHN KOR \n  9   8   1 \n\n[[4]]\nnationalites\n    USA \n  5   5 \n\n[[5]]\nnationalites\n    CUB HUN \n  3   2   1 \n\n[[6]]\nnationalites\n    GER \n  1   1 \n```\n:::\n:::\n\n\nNous pouvons donc à présent déterminer la nationalité la plus présente parmi les athlètes. De la même manière que pour la fonction calcul_medailles_individuelles, nous utilisons un code qui parcourt les résultats des médailles d'or pour chaque sport d'été, extrait les nationalités des athlètes et compte le nombre total d'occurrences de chaque nationalité. Ensuite, il crée un tibble pour stocker ces données et les assemble dans une liste. Enfin, il combine tous les résultats en un seul tibble, agrège le total des occurrences par nationalité, puis identifie les trois nationalités les plus présentes.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlist_nationalite_ete <- list()\n\nfor (i in seq_along(sport_ete$Athletes_or)) {\n  matches <- str_match_all(sport_ete$Athletes_or[i], \"\\\\((\\\\w{3})\\\\)\")\n  \n  nationalites_ete <- matches[[1]][,2]\n  \n  total_occurrences <- table(nationalites_ete)\n  \n  df <- tibble(\n    Nationalite = names(total_occurrences),\n    Total = as.integer(total_occurrences)\n  )\n  \n  list_nationalite_ete[[i]] <- df\n}\n\ntop_nationalites_ete <- do.call(rbind, list_nationalite_ete)\n\ntop_nationalites_ete <- aggregate(Total ~ Nationalite, data = top_nationalites_ete, sum)\n\ntop_3_nationalites_ete <- head(top_nationalites_ete[order(top_nationalites_ete$Total, decreasing = TRUE), ], 3)\nknitr::kable(top_3_nationalites_ete)\n```\n\n::: {.cell-output-display}\n|   |Nationalite | Total|\n|:--|:-----------|-----:|\n|21 |USA         |    21|\n|3  |CHN         |    13|\n|4  |CUB         |     8|\n:::\n:::\n\n\nAinsi, nous apprenons que les nationalités les plus présentes sont les États-Unis avec 21 athlètes médaillés d'or, suivis par la Chine avec 13, et enfin Cuba avec 8 athlètes médaillés d'or.\n\n## Médaillés des jeux olympiques d'hiver\n\nCette fois, nous travaillerons sur les médaillés des Jeux Olympiques d'hiver. De la même manière, nous préparons notre base de données et corrigeons les erreurs possibles.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsport_hiver <- data.frame(list_tables[2])\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsport_hiver <- sport_hiver[-1,-1]\n\nnames(sport_hiver)<-c(\"Discipline\", \"Annees\", \"Editions\", \"Epreuves_2020\", \"Or\", \"Argent\", \"Bronze\", \"Total\", \"Athletes_medailles\", \"Athletes_or\")\n\nsport_hiver[c(\"Editions\", \"Epreuves_2020\", \"Or\", \"Argent\", \"Bronze\", \"Total\")] <- lapply(sport_hiver[c(\"Editions\", \"Epreuves_2020\", \"Or\", \"Argent\", \"Bronze\", \"Total\")], as.integer)\n\nstr(sport_hiver)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n'data.frame':\t15 obs. of  10 variables:\n $ Discipline        : chr  \"Biathlon\" \"Bobsleigh\" \"Combiné nordique\" \"Curling\" ...\n $ Annees            : chr  \"1924,Depuis 1960\" \"1924-1956,depuis 1964\" \"Depuis 1924\" \"1924,depuis 1998\" ...\n $ Editions          : int  16 21 22 4 23 14 24 22 7 22 ...\n $ Epreuves_2020     : int  11 3 3 2 2 4 4 12 8 4 ...\n $ Or                : int  54 39 28 7 24 37 77 152 32 38 ...\n $ Argent            : int  54 37 28 7 24 35 75 155 32 39 ...\n $ Bronze            : int  54 39 28 7 24 36 76 148 32 37 ...\n $ Total             : int  162 115 84 21 72 108 228 455 96 114 ...\n $ Athletes_medailles: chr  \"Ole Einar Bjørndalen (NOR) (8-4-1)\" \"Bogdan Musiol (RDA) (1-5-1)\" \"Felix Gottwald (AUT) (3-1-3)\" \"Anna Le Moine (SWE) (2-0-0) Cathrine Lindahl (SWE) (2-0-0) Eva Lund (SWE) (2-0-0) Anette Norberg (SWE) (2-0-0)\\\"| __truncated__ ...\n $ Athletes_or       : chr  \"Ole Einar Bjørndalen (NOR) (8-4-1)\" \"Kevin Kuske (GER) (4-1-0) André Lange (GER) (4-1-0)\" \"Samppa Lajunen (FIN) (3-2-0)\\n Eric Frenzel (GER) (3-1-2)\\n Felix Gottwald (AUT) (3-1-3) Johan Grøttumsbråten (\"| __truncated__ \"Anna Le Moine (SWE) (2-0-0) Cathrine Lindahl (SWE) (2-0-0) Eva Lund (SWE) (2-0-0) Anette Norberg (SWE) (2-0-0)\\\"| __truncated__ ...\n```\n:::\n\n```{.r .cell-code}\nknitr::kable(head(sport_hiver))\n```\n\n::: {.cell-output-display}\n|   |Discipline       |Annees                           | Editions| Epreuves_2020| Or| Argent| Bronze| Total|Athletes_medailles                                                                                                                                                                                                                                    |Athletes_or                                                                                                                                                                      |\n|:--|:----------------|:--------------------------------|--------:|-------------:|--:|------:|------:|-----:|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n|2  |Biathlon         |1924,Depuis 1960                 |       16|            11| 54|     54|     54|   162|Ole Einar Bjørndalen (NOR) (8-4-1)                                                                                                                                                                                                                    |Ole Einar Bjørndalen (NOR) (8-4-1)                                                                                                                                               |\n|3  |Bobsleigh        |1924-1956,depuis 1964            |       21|             3| 39|     37|     39|   115|Bogdan Musiol (RDA) (1-5-1)                                                                                                                                                                                                                           |Kevin Kuske (GER) (4-1-0) André Lange (GER) (4-1-0)                                                                                                                              |\n|4  |Combiné nordique |Depuis 1924                      |       22|             3| 28|     28|     28|    84|Felix Gottwald (AUT) (3-1-3)                                                                                                                                                                                                                          |Samppa Lajunen (FIN) (3-2-0)\n Eric Frenzel (GER) (3-1-2)\n Felix Gottwald (AUT) (3-1-3) Johan Grøttumsbråten (NOR) (3-1-2) Thorleif Haug (NOR) (3-0-0) Ulrich Wehling (RDA) (3-0-0) |\n|5  |Curling          |1924,depuis 1998                 |        4|             2|  7|      7|      7|    21|Anna Le Moine (SWE) (2-0-0) Cathrine Lindahl (SWE) (2-0-0) Eva Lund (SWE) (2-0-0) Anette Norberg (SWE) (2-0-0)\n Kaitlyn Lawes (CAN) (2-0-0)\n John Morris (CAN) (2-0-0)\n Kevin Martin (CAN) (1-1-0) Torger Nergård (NOR) (1-1-0) Mirjam Ott (SUI) (0-2-0) |Anna Le Moine (SWE) (2-0-0) Cathrine Lindahl (SWE) (2-0-0) Eva Lund (SWE) (2-0-0) Anette Norberg (SWE) (2-0-0)\n Kaitlyn Lawes (CAN) (2-0-0)\n John Morris (CAN) (2-0-0)             |\n|6  |Hockey sur glace |Été : 1920Hiver : Depuis 1924[1] |       23|             2| 24|     24|     24|    72|Jayna Hefford (CAN) (4-1-0) Hayley Wickenheiser (CAN) (4-1-0)                                                                                                                                                                                         |Jayna Hefford (CAN) (4-1-0) Hayley Wickenheiser (CAN) (4-1-0)\n Caroline Ouellette (CAN) (4-0-0)                                                                                   |\n|7  |Luge             |Depuis 1964                      |       14|             4| 37|     35|     36|   108|Armin Zöggeler (ITA) (2-1-3)                                                                                                                                                                                                                          |Natalie Geisenberger (GER) (4-0-1) Tobias Arlt (GER) (4-0-0)\n Tobias Wendl (GER) (4-0-0)                                                                                          |\n:::\n:::\n\n\nNous allons maintenant chercher à appliquer les fonctions calcul_medailles_individuelles et extraire_nationalite_athlete sur la base de données des Jeux Olympiques d'hiver.\n\nDe la même manière que pour les Jeux Olympiques d'été, nous appliquons à l'ensemble du jeu de données la fonction calcul_medailles_individuelles, mais cette fois-ci avec la fonction map du package purrr et non plus la fonction lapply. La principale différence entre les deux fonction est que `map` peut être utilisé avec des structures de données de type liste, vecteur, ou data frame, tandis que `lapply` est spécifiquement conçu pour les listes.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nresultats_medailles_hiver <- map(sport_hiver$Athletes_medailles, calcul_medailles_individuelles)\nhead(resultats_medailles_hiver)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[[1]]\n[1] 13\n\n[[2]]\n[1] 7\n\n[[3]]\n[1] 7\n\n[[4]]\n[1] 2 2 2 2 2 2 2 2 2\n\n[[5]]\n[1] 5 5\n\n[[6]]\n[1] 6\n```\n:::\n:::\n\n\nNous observons qu'il n'y a pas de différence significative entre les deux fonctions.\n\nMaintenant que la fonction est appliquée à l'ensemble de nos données, on peut chercher quels athlètes ont été le plus médaillés pour les Jeux Olympiques d'hiver.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlist_medaille_hiver <- list()\n\nfor (i in seq_along(resultats_medailles_hiver)) {\n  matches <- str_match_all(sport_hiver$Athletes_medailles[i],\"([^\\\\(]+\\\\s\\\\([^\\\\)]+\\\\))\\\\s*\\\\((\\\\d+)-(\\\\d+)-(\\\\d+)\\\\)\")\n  \n  df<- tibble(\n    Athlete = trimws(matches[[1]][,1]),\n    Medailles=resultats_medailles_hiver[[i]]\n)\n  list_medaille_hiver[[i]]<-df\n}\n\ntop_medailles_hiver<-do.call(rbind,list_medaille_hiver)\nknitr::kable(head(top_medailles_hiver))\n```\n\n::: {.cell-output-display}\n|Athlete                            | Medailles|\n|:----------------------------------|---------:|\n|Ole Einar Bjørndalen (NOR) (8-4-1) |        13|\n|Bogdan Musiol (RDA) (1-5-1)        |         7|\n|Felix Gottwald (AUT) (3-1-3)       |         7|\n|Anna Le Moine (SWE) (2-0-0)        |         2|\n|Cathrine Lindahl (SWE) (2-0-0)     |         2|\n|Eva Lund (SWE) (2-0-0)             |         2|\n:::\n\n```{.r .cell-code}\ntop_3_medailles_hiver <- head(top_medailles_hiver[order(top_medailles_hiver$Medailles, decreasing = TRUE), ], 3)\nknitr::kable(top_3_medailles_hiver)\n```\n\n::: {.cell-output-display}\n|Athlete                            | Medailles|\n|:----------------------------------|---------:|\n|Marit Bjørgen (NOR) (8-4-3)        |        15|\n|Ole Einar Bjørndalen (NOR) (8-4-1) |        13|\n|Ireen Wüst (NED) (5-5-1)           |        11|\n:::\n:::\n\n\nNous apprenons ainsi que les 3 athlètes avec le plus de médailles sont Marit Bjørgen avec un total de 15 médailles, suivi de Ole Einar Bjørndalen avec 13 médailles, et pour compléter le tableau, Ireen Wüst avec 11 médailles.\n\nNous allons à présent appliquer la fonction extraire_nationalite_athletes, mais également avec la fonction map du package purrr et non plus la fonction lapply.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nresultat_nationalite_hiver <- map(sport_hiver$Athletes_or,extraire_nationalite_athlete)\n\nhead(resultat_nationalite_hiver)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[[1]]\nnationalites\n    NOR \n  1   1 \n\n[[2]]\nnationalites\n    GER \n  2   2 \n\n[[3]]\nnationalites\n    AUT FIN GER NOR RDA \n  6   1   1   1   2   1 \n\n[[4]]\nnationalites\n    CAN SWE \n  6   2   4 \n\n[[5]]\nnationalites\n    CAN \n  3   3 \n\n[[6]]\nnationalites\n    GER \n  3   3 \n```\n:::\n:::\n\n\nDe la même manière que pour la fonction précédente, nous observons qu'il n'y a pas de différence significative entre les deux fonctions.\n\nMaintenant que la fonction est appliquée à l'ensemble de nos données, on peut chercher quels athlètes ont été le plus médaillés pour les Jeux Olympiques d'hiver.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlist_nationalite_hiver <- list()\n\nfor (i in seq_along(sport_hiver$Athletes_or)) {\n  matches <- str_match_all(sport_hiver$Athletes_or[i], \"\\\\((\\\\w{3})\\\\)\")\n  \n  nationalites_hiver <- matches[[1]][,2]\n  \n  total_occurrences <- table(nationalites_hiver)\n  \n  df <- tibble(\n    Nationalite = names(total_occurrences),\n    Total = as.integer(total_occurrences)\n  )\n  \n  list_nationalite_hiver[[i]] <- df\n}\n\ntop_nationalites_hiver <- do.call(rbind, list_nationalite_hiver)\n\ntop_nationalites_hiver <- aggregate(Total ~ Nationalite, data = top_nationalites_hiver, sum)\n\ntop_3_nationalites_hiver <- head(top_nationalites_hiver[order(top_nationalites_hiver$Total, decreasing = TRUE), ], 3)\nknitr::kable(top_3_nationalites_hiver)\n```\n\n::: {.cell-output-display}\n|   |Nationalite | Total|\n|:--|:-----------|-----:|\n|2  |CAN         |     8|\n|7  |NOR         |     7|\n|6  |GER         |     6|\n:::\n:::\n\n\nNous apprenons ainsi que pour les Jeux Olympiques d'hiver, les nationalités les plus présentes pour les médailles d'or sont en premier le Canada avec 8 médaillés, suivis de la Norvège avec 7 et pour finir l'Allemagne avec 6 médaillés d'or.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}