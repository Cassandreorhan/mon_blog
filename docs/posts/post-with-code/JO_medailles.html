<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Cassandre Orhan">
<meta name="dcterms.date" content="2024-03-09">

<title>Mon blog - Les jeux olympiques : médailles des athlètes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Mon blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">Presentation</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Les jeux olympiques : médailles des athlètes</h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Cassandre Orhan </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">March 9, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p>L’objectif de ce rapport est d’analyser les performances des athlètes aux Jeux Olympiques en termes d’éditions et de médailles remportées. Cette analyse nous permettra de comprendre les tendances historiques en matière de succès sportifs et d’identifier les pays dominants dans l’histoire des Jeux Olympiques.</p>
<section id="librairie" class="level2">
<h2 class="anchored" data-anchor-id="librairie">Librairie</h2>
<p>Dans le cadre de ce rapport, nous nous appuierons sur des bibliothèques disponibles dans le CRAN.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rvest)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="préparation-de-la-base-de-données" class="level2">
<h2 class="anchored" data-anchor-id="préparation-de-la-base-de-données">Préparation de la base de données</h2>
<p>Nous avons dans un premier temps importé notre base de données :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>list_tables <span class="ot">&lt;-</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">session</span>(</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"https://fr.wikipedia.org/wiki/Liste_des_m%C3%A9daill%C3%A9s_olympiques"</span>)<span class="sc">|&gt;</span> </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_elements</span>(<span class="st">".wikitable"</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_table</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>L’objet <code>list_tables</code> contient les données de toutes les tables HTML de classe “wikitable” trouvées sur la page Wikipedia spécifiée. Dans ce cas, il contient la liste des médaillés olympiques selon six tables distinctes :</p>
<ul>
<li><p>Sports des Jeux Olympiques d’été</p></li>
<li><p>Sports des Jeux Olympiques d’hiver</p></li>
<li><p>Anciens sports d’été</p></li>
<li><p>Anciens sports d’hiver</p></li>
<li><p>Par édition, Jeux Olympiques d’été</p></li>
<li><p>Par édition, Jeux Olympiques d’hiver</p></li>
</ul>
<p>Ces différentes tables contiennent des informations sur les médailles olympiques attribuées aux athlètes dans différentes disciplines et éditions des Jeux Olympiques,</p>
</section>
<section id="médaillés-des-jeux-olympiques-dété" class="level2">
<h2 class="anchored" data-anchor-id="médaillés-des-jeux-olympiques-dété">Médaillés des jeux olympiques d’été</h2>
<p>La première étape de cet exercice consistait à préparer la base de données en supprimant les lignes et les colonnes inutiles, ainsi qu’en renommant les colonnes et les lignes pour plus de lisibilité. Cette étape est essentielle pour assurer que les données sont bien organisées et faciles à analyser par la suite. En nettoyant la base de données et en la structurant de manière claire, nous pouvons faciliter les étapes d’analyse et d’interprétation des données</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>sport_ete <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(list_tables[<span class="dv">1</span>])</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>sport_ete <span class="ot">&lt;-</span> sport_ete[<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(sport_ete)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"Discipline"</span>, <span class="st">"Annees"</span>, <span class="st">"Editions"</span>, <span class="st">"Epreuves_2020"</span>, <span class="st">"Or"</span>, <span class="st">"Argent"</span>, <span class="st">"Bronze"</span>, <span class="st">"Total"</span>, <span class="st">"Athletes_medailles"</span>, <span class="st">"Athletes_or"</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>sport_ete[<span class="fu">c</span>(<span class="st">"Editions"</span>, <span class="st">"Epreuves_2020"</span>, <span class="st">"Or"</span>, <span class="st">"Argent"</span>, <span class="st">"Bronze"</span>, <span class="st">"Total"</span>)] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(sport_ete[<span class="fu">c</span>(<span class="st">"Editions"</span>, <span class="st">"Epreuves_2020"</span>, <span class="st">"Or"</span>, <span class="st">"Argent"</span>, <span class="st">"Bronze"</span>, <span class="st">"Total"</span>)], as.integer)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>sport_ete<span class="sc">$</span>Athletes_or <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(sport_ete<span class="sc">$</span>Athletes_or <span class="sc">==</span> <span class="st">"17 athlètes avec 1 médaille d'or"</span>, <span class="st">"Chandler Egan (USA) (1-1-0)"</span>, sport_ete<span class="sc">$</span>Athletes_or)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>sport_ete<span class="sc">$</span>Athletes_or [<span class="fu">c</span>(<span class="dv">30</span>)] <span class="ot">&lt;-</span> <span class="st">"Dezső Gyarmati (HUN) (3-1-1)"</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(sport_ete)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   30 obs. of  10 variables:
 $ Discipline        : chr  "Athlétisme" "Aviron" "Badminton" "Basket-ball" ...
 $ Annees            : chr  "Depuis 1896" "Depuis 1900" "Depuis 1992" "Depuis 1936" ...
 $ Editions          : int  29 28 8 20 26 20 29 26 29 27 ...
 $ Epreuves_2020     : int  48 14 5 4 13 16 22 6 12 2 ...
 $ Or                : int  1028 269 39 32 266 242 263 151 223 34 ...
 $ Argent            : int  1030 268 39 32 266 241 261 149 223 34 ...
 $ Bronze            : int  1027 273 43 32 472 243 260 148 221 35 ...
 $ Total             : int  3085 810 121 96 1004 726 784 448 667 103 ...
 $ Athletes_medailles: chr  "Paavo Nurmi (FIN) (9-3-0)" "Elisabeta Lipă (ROU) (5-2-1)" "Gao Ling (CHN) (2-1-1)" "Teresa Edwards (USA) (4-0-1)" ...
 $ Athletes_or       : chr  "Paavo Nurmi (FIN) (9-3-0) Carl Lewis (USA) (9-1-0)" "Elisabeta Lipă (ROU) (5-2-1) Georgeta Damian (ROU) (5-0-1) Steven Redgrave (GBR) (5-0-1)" "Gao Ling (CHN) (2-1-1) Kim Dong-moon (KOR) (2-0-1) Zhang Nan (CHN) (2-0-1) Ge Fei (CHN) (2-0-0) Gu Jun (CHN) (2"| __truncated__ "Teresa Edwards (USA) (4-0-1) Sue Bird (USA) (4-0-0) Tamika Catchings (USA) (4-0-0) Lisa Leslie (USA) (4-0-0) Di"| __truncated__ ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(sport_ete)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 30 10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(sport_ete))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 0%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 0%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 49%">
<col style="width: 35%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Discipline</th>
<th style="text-align: left;">Annees</th>
<th style="text-align: right;">Editions</th>
<th style="text-align: right;">Epreuves_2020</th>
<th style="text-align: right;">Or</th>
<th style="text-align: right;">Argent</th>
<th style="text-align: right;">Bronze</th>
<th style="text-align: right;">Total</th>
<th style="text-align: left;">Athletes_medailles</th>
<th style="text-align: left;">Athletes_or</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: left;">Athlétisme</td>
<td style="text-align: left;">Depuis 1896</td>
<td style="text-align: right;">29</td>
<td style="text-align: right;">48</td>
<td style="text-align: right;">1028</td>
<td style="text-align: right;">1030</td>
<td style="text-align: right;">1027</td>
<td style="text-align: right;">3085</td>
<td style="text-align: left;">Paavo Nurmi (FIN) (9-3-0)</td>
<td style="text-align: left;">Paavo Nurmi (FIN) (9-3-0) Carl Lewis (USA) (9-1-0)</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: left;">Aviron</td>
<td style="text-align: left;">Depuis 1900</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">269</td>
<td style="text-align: right;">268</td>
<td style="text-align: right;">273</td>
<td style="text-align: right;">810</td>
<td style="text-align: left;">Elisabeta Lipă (ROU) (5-2-1)</td>
<td style="text-align: left;">Elisabeta Lipă (ROU) (5-2-1) Georgeta Damian (ROU) (5-0-1) Steven Redgrave (GBR) (5-0-1)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4</td>
<td style="text-align: left;">Badminton</td>
<td style="text-align: left;">Depuis 1992</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">39</td>
<td style="text-align: right;">39</td>
<td style="text-align: right;">43</td>
<td style="text-align: right;">121</td>
<td style="text-align: left;">Gao Ling (CHN) (2-1-1)</td>
<td style="text-align: left;">Gao Ling (CHN) (2-1-1) Kim Dong-moon (KOR) (2-0-1) Zhang Nan (CHN) (2-0-1) Ge Fei (CHN) (2-0-0) Gu Jun (CHN) (2-0-0) Lin Dan (CHN) (2-0-0) Zhang Jun (CHN) (2-0-0) Zhang Ning (CHN) (2-0-0) Zhao Yunlei (CHN) (2-0-0)</td>
</tr>
<tr class="even">
<td style="text-align: left;">5</td>
<td style="text-align: left;">Basket-ball</td>
<td style="text-align: left;">Depuis 1936</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">96</td>
<td style="text-align: left;">Teresa Edwards (USA) (4-0-1)</td>
<td style="text-align: left;">Teresa Edwards (USA) (4-0-1) Sue Bird (USA) (4-0-0) Tamika Catchings (USA) (4-0-0) Lisa Leslie (USA) (4-0-0) Diana Taurasi (USA) (4-0-0)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">6</td>
<td style="text-align: left;">Boxe</td>
<td style="text-align: left;">1904, 1908,depuis 1920</td>
<td style="text-align: right;">26</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">266</td>
<td style="text-align: right;">266</td>
<td style="text-align: right;">472</td>
<td style="text-align: right;">1004</td>
<td style="text-align: left;">László Papp (HUN) (3-0-0) Félix Savón (CUB) (3-0-0) Teófilo Stevenson (CUB) (3-0-0) Roniel Iglesias (CUB) (2-0-1) Boris Lagutin (URS) (2-0-1) Oleg Saitov (RUS) (2-0-1) Zou Shiming (CHN) (2-0-1) Roberto Cammarelle (ITA) (1-1-1) Zbigniew Pietrzykowski (POL) (0-1-2) Arnold Vanderlyde (NED) (0-0-3)</td>
<td style="text-align: left;">László Papp (HUN) (3-0-0) Félix Savón (CUB) (3-0-0) Teófilo Stevenson (CUB) (3-0-0)</td>
</tr>
<tr class="even">
<td style="text-align: left;">7</td>
<td style="text-align: left;">Canoë-kayak</td>
<td style="text-align: left;">Depuis 1936</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">242</td>
<td style="text-align: right;">241</td>
<td style="text-align: right;">243</td>
<td style="text-align: right;">726</td>
<td style="text-align: left;">Birgit Fischer (GER) (8-4-0)</td>
<td style="text-align: left;">Birgit Fischer (GER) (8-4-0)</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Cette base de données, référençant les médaillés pour les Jeux Olympiques d’été, est composée de 10 colonnes et 30 lignes. Les colonnes sont :</p>
<ul>
<li><p>Les disciplines pratiquées,</p></li>
<li><p>Des informations sur leurs années d’édition, depuis quand ? Est ce qu’il y a eu des coupures ?</p></li>
<li><p>Le nombre d’éditions,</p></li>
<li><p>Le nombre d’épreuves durant la dernière édition correspondant à 2020,</p></li>
<li><p>Le nombre de médailles d’or, d’argent et de bronze ainsi que le total de médailles,</p></li>
<li><p>Les athlètes médaillés ainsi que les athlètes ayant obtenu au moins une médaille d’or.</p></li>
</ul>
</section>
<section id="disciplines-avec-le-plus-de-médailles-distribués" class="level2">
<h2 class="anchored" data-anchor-id="disciplines-avec-le-plus-de-médailles-distribués">Disciplines avec le plus de médailles distribués</h2>
<p>L’objectif de ce code est de déterminer le top 3 des disciplines avec le plus grand nombre de médailles distribuées aux Jeux Olympiques. Pour ce faire, nous commençons par trier la colonne contenant le nombre total de médailles dans un ordre croissant. Ensuite, nous sélectionnons les trois disciplines les plus pertinentes pour notre analyse.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>max_tt<span class="ot">&lt;-</span><span class="fu">max</span>(sport_ete<span class="sc">$</span>Total)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>top_3 <span class="ot">&lt;-</span> <span class="fu">head</span>(sport_ete[<span class="fu">order</span>(sport_ete<span class="sc">$</span>Total, <span class="at">decreasing =</span> <span class="cn">TRUE</span>), ], <span class="dv">3</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(top_3[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">8</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Discipline</th>
<th style="text-align: right;">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: left;">Athlétisme</td>
<td style="text-align: right;">3085</td>
</tr>
<tr class="even">
<td style="text-align: left;">19</td>
<td style="text-align: left;">Natation(hommes, femmes)</td>
<td style="text-align: right;">1814</td>
</tr>
<tr class="odd">
<td style="text-align: left;">18</td>
<td style="text-align: left;">Lutte</td>
<td style="text-align: right;">1358</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Nous constatons ainsi que les disciplines avec le plus grand nombre de médailles distribuées sont l’athlétisme, la natation et la lutte.</p>
</section>
<section id="disciplines-avec-le-moins-de-dépreuve-en-2020" class="level2">
<h2 class="anchored" data-anchor-id="disciplines-avec-le-moins-de-dépreuve-en-2020">Disciplines avec le moins de d’épreuve en 2020</h2>
<p>L’objectif de ce code est de trier les disciplines en fonction du nombre d’épreuves le moins élevé lors des Jeux Olympiques de 2020, on effectue un trie dans un ordre décroissant. En effectuant ce tri, nous pouvons identifier les disciplines qui ont eu moins de représentation ou de diversité d’épreuves lors de la dernière édition des Jeux Olympiques</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>epreuves_2020<span class="ot">&lt;-</span><span class="fu">head</span>(sport_ete[<span class="fu">order</span>(sport_ete<span class="sc">$</span>Epreuves_2020,<span class="at">decreasing=</span><span class="cn">FALSE</span>),])</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(epreuves_2020[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Discipline</th>
<th style="text-align: right;">Epreuves_2020</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">11</td>
<td style="text-align: left;">Football</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">12</td>
<td style="text-align: left;">Golf</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">14</td>
<td style="text-align: left;">Handball</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">16</td>
<td style="text-align: left;">Hockey sur gazon</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">20</td>
<td style="text-align: left;">Natation synchronisée</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">21</td>
<td style="text-align: left;">Pentathlon moderne</td>
<td style="text-align: right;">2</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Ainsi, parmi les disciplines ayant été les moins représentées lors de l’édition des Jeux Olympiques de 2020, on retrouve notamment le football et le golf.</p>
</section>
<section id="fonction-calcul_nb_edition.int" class="level2">
<h2 class="anchored" data-anchor-id="fonction-calcul_nb_edition.int">Fonction calcul_nb_edition.int</h2>
<p>Le but de cette fonction est de calculer le nombre d’éditions auxquelles une épreuve a été présente aux Jeux Olympiques pour les années données. Pour ce faire, la fonction effectue les étapes suivantes :</p>
<ul>
<li><p>Soustrait l’année donnée de 2020.</p></li>
<li><p>Divise le résultat par la fréquence des Jeux Olympiques, qui correspond à 4 car les Jeux ont lieu tous les quatre ans.</p></li>
<li><p>Ajoute une édition supplémentaire pour l’édition 2020.</p></li>
<li><p>Tient compte des éditions qui n’ont pas eu lieu, notamment en raison des guerres mondiales.</p></li>
</ul>
<p>Cette fonction ne prend en compte que des caractères numériques en entrée.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>calcul_nb_editions.int <span class="ot">&lt;-</span> <span class="cf">function</span>(depuis) {</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  editions <span class="ot">&lt;-</span> (((<span class="dv">2020</span><span class="sc">-</span>depuis) <span class="sc">/</span> <span class="dv">4</span>) <span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (depuis <span class="sc">&lt;=</span> <span class="dv">1916</span>) {</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    editions <span class="ot">&lt;-</span> editions <span class="sc">-</span> <span class="dv">3</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (depuis <span class="sc">&lt;=</span> <span class="dv">1940</span>){</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>        editions <span class="ot">&lt;-</span> editions <span class="sc">-</span> <span class="dv">2</span>}</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>      <span class="cf">else</span> <span class="cf">if</span> (depuis <span class="sc">&lt;=</span> <span class="dv">1944</span>){ </span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>        editions <span class="ot">&lt;-</span> editions <span class="sc">-</span> <span class="dv">1</span>}</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(editions)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="fu">calcul_nb_editions.int</span>(<span class="dv">1920</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 24</code></pre>
</div>
</div>
<p>Donc, pour une épreuve présente depuis 1920, la fonction dénombrera 24 éditions au total.</p>
</section>
<section id="fonction-calcul_nb_edition.str" class="level2">
<h2 class="anchored" data-anchor-id="fonction-calcul_nb_edition.str">Fonction calcul_nb_edition.str</h2>
<p>On a repris la fonction qui permet de calculer le nombre d’édition mais on l’adapte maintenant au chaîne de caractère. La fonction prend donc en compte trois possibilités pour les chaînes de caractères représentant les années :</p>
<ul>
<li><p>Si l’année indiquée est de la forme “1904-1924”, alors la fonction soustrait 1904 de 1924, divise le résultat par la fréquence des Jeux Olympiques, et ajoute “+1” pour l’année 1924.</p></li>
<li><p>Si l’année indiquée est de la forme “depuis 1904” (ou “Depuis”), la fonction fonctionnera de la même manière que pour le calcul standard du nombre d’éditions.</p></li>
<li><p>Si l’année indiquée est unique, la fonction comptera simplement une édition supplémentaire.</p></li>
</ul>
<p>Cette fonction continue de prendre en compte les années où les Jeux Olympiques n’ont pas eu lieu en raison des guerres mondiales, afin de fournir un calcul précis du nombre d’éditions pour une épreuve donnée.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>calcul_nb_editions.str <span class="ot">&lt;-</span> <span class="cf">function</span>(annees) {</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  annees <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">s+"</span>, <span class="st">""</span>, annees)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  years <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">strsplit</span>(annees, <span class="st">","</span>))</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  nb_editions <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (annee <span class="cf">in</span> years) {</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">grepl</span>(<span class="st">"-"</span>, annee)) {</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>      range <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(<span class="fu">strsplit</span>(annee, <span class="st">"-"</span>)))</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>      nb_editions <span class="ot">&lt;-</span> nb_editions <span class="sc">+</span> (((range[<span class="dv">2</span>] <span class="sc">-</span> range[<span class="dv">1</span>]) <span class="sc">%/%</span> <span class="dv">4</span> )<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (range[<span class="dv">2</span>] <span class="sc">&gt;=</span> <span class="dv">1944</span>) nb_editions <span class="ot">&lt;-</span> nb_editions <span class="sc">-</span> <span class="dv">3</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>      <span class="cf">else</span> <span class="cf">if</span> (range[<span class="dv">2</span>] <span class="sc">&gt;=</span> <span class="dv">1940</span>) nb_editions <span class="ot">&lt;-</span> nb_editions <span class="sc">-</span> <span class="dv">2</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>      <span class="cf">else</span> <span class="cf">if</span> (range[<span class="dv">2</span>] <span class="sc">&gt;=</span> <span class="dv">1916</span>) nb_editions <span class="ot">&lt;-</span> nb_editions <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    } </span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">grepl</span>(<span class="st">"depuis"</span>, <span class="fu">tolower</span>(annee))) {</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>      debut <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"[^0-9]"</span>, <span class="st">""</span>, annee))</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>      nb_editions <span class="ot">&lt;-</span> nb_editions <span class="sc">+</span> ((<span class="dv">2024</span> <span class="sc">-</span> debut) <span class="sc">%/%</span> <span class="dv">4</span>)</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (debut <span class="sc">&lt;=</span> <span class="dv">1916</span>) nb_editions <span class="ot">&lt;-</span> nb_editions <span class="sc">-</span> <span class="dv">3</span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>      <span class="cf">else</span> <span class="cf">if</span> (debut <span class="sc">&lt;=</span> <span class="dv">1940</span>) nb_editions <span class="ot">&lt;-</span> nb_editions <span class="sc">-</span> <span class="dv">2</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>      <span class="cf">else</span> <span class="cf">if</span> (debut <span class="sc">&lt;=</span> <span class="dv">1944</span>) nb_editions <span class="ot">&lt;-</span> nb_editions <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>      nb_editions <span class="ot">&lt;-</span> nb_editions <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(nb_editions)</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>nb_editions <span class="ot">&lt;-</span><span class="fu">calcul_nb_editions.str</span>(<span class="st">"1896, 1904, depuis 1920"</span>)</span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>nb_editions</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 26</code></pre>
</div>
</div>
<p>Par exemple, si l’on indique qu’une discipline a été présente aux JO en 1896, 1904 et depuis 1920, alors la fonction a compté 2 dates uniques et ajouté le nombre d’éditions calculé avec “depuis 1920”. Ici, la fonction nous retourne 26 éditions.</p>
</section>
<section id="fonction-calcul_nb_edition" class="level2">
<h2 class="anchored" data-anchor-id="fonction-calcul_nb_edition">Fonction calcul_nb_edition</h2>
<p>Notre fonction permet donc de calculer le nombre d’éditions auxquelles une discipline est présente aux JO, que l’on renseigne une année précise ou une chaîne de caractères.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>calcul_nb_editions <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.character</span>(x)) {</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">calcul_nb_editions.str</span>(x)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span>(<span class="fu">is.numeric</span>(x)) {</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">calcul_nb_editions.int</span>(x)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="fu">calcul_nb_editions</span>(<span class="st">"1904-1924, depuis 1948"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 24</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">calcul_nb_editions</span>(<span class="dv">2000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6</code></pre>
</div>
</div>
<p>Ainsi, la fonction nous retourne 24 éditions pour la chaîne de caractère “1904-1924, depuis 1948” et 6 éditions pour l’année 2000.</p>
</section>
<section id="fonction-calcul_medailles_individuelles" class="level2">
<h2 class="anchored" data-anchor-id="fonction-calcul_medailles_individuelles">Fonction calcul_medailles_individuelles</h2>
<p>L’objectif de cette fonction est de fournir le nombre maximal de médailles obtenues par un athlète lors des olympiades dans une même cellule. Cette fonction prend en compte la possibilité que plusieurs athlètes puissent être mentionnés et permet ainsi de les distinguer. Elle identifie le nombre maximal de médailles attribuées à un seul athlète au sein d’une cellule donnée, offrant ainsi une analyse claire et précise des performances individuelles aux Jeux Olympiques.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>calcul_medailles_individuelles <span class="ot">&lt;-</span> <span class="cf">function</span>(data){ </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  athletes <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">str_split</span>(data,<span class="st">"</span><span class="sc">\\</span><span class="st">)</span><span class="sc">\\</span><span class="st">s"</span>,<span class="at">simplify=</span><span class="cn">TRUE</span>))</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  resultats <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(athletes))</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(athletes)){</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    medailles <span class="ot">&lt;-</span> <span class="fu">str_extract_all</span>(athletes[i],<span class="st">"</span><span class="sc">\\</span><span class="st">d+"</span>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(medailles[[<span class="dv">1</span>]])<span class="sc">&gt;</span><span class="dv">0</span>){</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>      chiffres<span class="ot">&lt;-</span> <span class="fu">as.integer</span>(medailles[[<span class="dv">1</span>]])</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>      resultats[i] <span class="ot">&lt;-</span><span class="fu">sum</span>(chiffres)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(resultats[resultats <span class="sc">!=</span><span class="dv">0</span>])</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a><span class="fu">calcul_medailles_individuelles</span>(<span class="fu">c</span>(<span class="st">"Larissa Latynina (URS) (9-5-4)"</span>, <span class="st">"Teddy Riner (FRA) (3-0-2) Ryōko Tani (JPN) (2-2-1)"</span>,<span class="st">"Elisabeta Lipă (ROU) (5-2-1)"</span>,<span class="st">"    </span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a><span class="st">Isabell Werth (GER) (7-5-0)"</span>,<span class="st">"Ana Fernández (CUB) (3-0-1) Kerri Walsh (USA) (3-0-1) Inna Ryskal (URS) (2-2-0) Sérgio Dutra Santos (BRA) (2-2-0) Sergey Tetyukhin (RUS) (1-1-2)"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 18  5  8 12  4  5  4  4  4  4</code></pre>
</div>
</div>
<p>Ainsi, Larissa Latynina a reçu 18 médailles, Teddy Riner en a reçu 5, etc.</p>
<p>À présent, nous souhaitons identifier les 3 athlètes ayant reçu le plus de médailles en appliquant la fonction précédemment créée à toute la colonne “Athletes_medailles”. Cela nous permettra de déterminer le nombre de médailles reçues par chacun des athlètes, facilitant ainsi l’identification des trois athlètes les plus médaillés.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>resultats_medailles_ete <span class="ot">&lt;-</span> <span class="fu">lapply</span>(sport_ete<span class="sc">$</span>Athletes_medailles,calcul_medailles_individuelles)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(resultats_medailles_ete)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] 12

[[2]]
[1] 8

[[3]]
[1] 4

[[4]]
[1] 5

[[5]]
 [1] 3 3 3 3 3 3 3 3 3 3

[[6]]
[1] 12</code></pre>
</div>
</div>
<p>Nous pouvons donc à présent déterminer les athlètes ayant reçu le plus de médailles. Pour cela, nous utilisons un code qui parcourt les résultats des médailles d’été pour chaque sport, extrait les noms des athlètes et le nombre de médailles correspondantes, puis les stocke dans un tibble. Enfin, il rassemble tous les résultats dans une liste, les combine en un seul tibble et identifie les trois athlètes avec le plus grand nombre de médailles d’été.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>list_medaille_ete <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(resultats_medailles_ete)) {</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  matches <span class="ot">&lt;-</span> <span class="fu">str_match_all</span>(sport_ete<span class="sc">$</span>Athletes_medailles[i],<span class="st">"([^</span><span class="sc">\\</span><span class="st">(]+</span><span class="sc">\\</span><span class="st">s</span><span class="sc">\\</span><span class="st">([^</span><span class="sc">\\</span><span class="st">)]+</span><span class="sc">\\</span><span class="st">))</span><span class="sc">\\</span><span class="st">s*</span><span class="sc">\\</span><span class="st">((</span><span class="sc">\\</span><span class="st">d+)-(</span><span class="sc">\\</span><span class="st">d+)-(</span><span class="sc">\\</span><span class="st">d+)</span><span class="sc">\\</span><span class="st">)"</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  df<span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Athlete =</span> <span class="fu">trimws</span>(matches[[<span class="dv">1</span>]][,<span class="dv">1</span>]),</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Medailles=</span>resultats_medailles_ete[[i]]</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  list_medaille_ete[[i]]<span class="ot">&lt;-</span>df</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>top_medailles_ete<span class="ot">&lt;-</span><span class="fu">do.call</span>(rbind,list_medaille_ete)</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(top_medailles_ete))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Athlete</th>
<th style="text-align: right;">Medailles</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Paavo Nurmi (FIN) (9-3-0)</td>
<td style="text-align: right;">12</td>
</tr>
<tr class="even">
<td style="text-align: left;">Elisabeta Lipă (ROU) (5-2-1)</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Gao Ling (CHN) (2-1-1)</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Teresa Edwards (USA) (4-0-1)</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">László Papp (HUN) (3-0-0)</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">Félix Savón (CUB) (3-0-0)</td>
<td style="text-align: right;">3</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>top_3_medailles_ete <span class="ot">&lt;-</span> <span class="fu">head</span>(top_medailles_ete[<span class="fu">order</span>(top_medailles_ete<span class="sc">$</span>Medailles, <span class="at">decreasing =</span> <span class="cn">TRUE</span>), ], <span class="dv">3</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(top_3_medailles_ete)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Athlete</th>
<th style="text-align: right;">Medailles</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Michael Phelps (USA) (23-3-2)</td>
<td style="text-align: right;">28</td>
</tr>
<tr class="even">
<td style="text-align: left;">Larissa Latynina (URS) (9-5-4)</td>
<td style="text-align: right;">18</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Edoardo Mangiarotti (ITA) (6-5-2)</td>
<td style="text-align: right;">13</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Ainsi, nous apprenons que les athlètes ayant reçu le plus de médailles sont Michael Phelps avec 28 médailles, suivi de Larissa Latynina avec 18 médailles à la deuxième place, et pour terminer Edoardo Mangiarotti avec 13 médailles.</p>
</section>
<section id="fonction-extraire_nationalite_athlete" class="level2">
<h2 class="anchored" data-anchor-id="fonction-extraire_nationalite_athlete">Fonction extraire_nationalite_athlete</h2>
<p>Le but de cette fonction est d’extraire la nationalité des athlètes afin d’analyser la présence des différentes nationalités. Pour cela,on utilise des expressions régulières pour extraire les segments entre parenthèses représentant les nationalités des athlètes, puis on compte le nombre d’occurrences de chaque nationalité et on retourne le résultat.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>extraire_nationalite_athlete <span class="ot">&lt;-</span> <span class="cf">function</span>(chaine) {</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  segments <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">str_extract_all</span>(chaine, <span class="st">"</span><span class="sc">\\</span><span class="st">([^</span><span class="sc">\\</span><span class="st">)]+</span><span class="sc">\\</span><span class="st">)"</span>))</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  nationalites <span class="ot">&lt;-</span> <span class="fu">character</span>(<span class="at">length =</span> <span class="fu">length</span>(segments))</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(segments)) {</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    matches <span class="ot">&lt;-</span> <span class="fu">str_match</span>(segments[i], <span class="st">"</span><span class="sc">\\</span><span class="st">((</span><span class="sc">\\</span><span class="st">w{3})</span><span class="sc">\\</span><span class="st">)$"</span>)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.na</span>(matches[<span class="dv">2</span>])) {</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>      nationalites[i] <span class="ot">&lt;-</span> matches[<span class="dv">2</span>]</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  counts <span class="ot">&lt;-</span> <span class="fu">table</span>(nationalites)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(counts)</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">extraire_nationalite_athlete</span>(<span class="fu">c</span>(<span class="st">"László Papp (HUN) (3-0-0) Félix Savón (CUB) (3-0-0) Teófilo Stevenson (CUB) (3-0-0)"</span>,<span class="st">"Aladár Gerevich (HUN) (7-1-2)</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>,<span class="st">"Christie Rampone (USA) (3-1-0) Shannon Boxx (USA) (3-0-0) Heather Mitts (USA) (3-0-0) Heather O'Reilly (USA) (3-0-0)</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">nationalites</th>
<th style="text-align: right;">Freq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: left;">CUB</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HUN</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">USA</td>
<td style="text-align: right;">4</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Avant de déterminer quelles nationalités sont les plus présentes, nous devons appliquer la fonction à l’ensemble de notre jeu de données.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>resultat_nationalite_ete <span class="ot">&lt;-</span> <span class="fu">lapply</span>(sport_ete<span class="sc">$</span>Athletes_or,extraire_nationalite_athlete)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(resultat_nationalite_ete)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
nationalites
    FIN USA 
  2   1   1 

[[2]]
nationalites
    GBR ROU 
  3   1   2 

[[3]]
nationalites
    CHN KOR 
  9   8   1 

[[4]]
nationalites
    USA 
  5   5 

[[5]]
nationalites
    CUB HUN 
  3   2   1 

[[6]]
nationalites
    GER 
  1   1 </code></pre>
</div>
</div>
<p>Nous pouvons donc à présent déterminer la nationalité la plus présente parmi les athlètes. De la même manière que pour la fonction calcul_medailles_individuelles, nous utilisons un code qui parcourt les résultats des médailles d’or pour chaque sport d’été, extrait les nationalités des athlètes et compte le nombre total d’occurrences de chaque nationalité. Ensuite, il crée un tibble pour stocker ces données et les assemble dans une liste. Enfin, il combine tous les résultats en un seul tibble, agrège le total des occurrences par nationalité, puis identifie les trois nationalités les plus présentes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>list_nationalite_ete <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(sport_ete<span class="sc">$</span>Athletes_or)) {</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  matches <span class="ot">&lt;-</span> <span class="fu">str_match_all</span>(sport_ete<span class="sc">$</span>Athletes_or[i], <span class="st">"</span><span class="sc">\\</span><span class="st">((</span><span class="sc">\\</span><span class="st">w{3})</span><span class="sc">\\</span><span class="st">)"</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  nationalites_ete <span class="ot">&lt;-</span> matches[[<span class="dv">1</span>]][,<span class="dv">2</span>]</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  total_occurrences <span class="ot">&lt;-</span> <span class="fu">table</span>(nationalites_ete)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Nationalite =</span> <span class="fu">names</span>(total_occurrences),</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total =</span> <span class="fu">as.integer</span>(total_occurrences)</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>  list_nationalite_ete[[i]] <span class="ot">&lt;-</span> df</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>top_nationalites_ete <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, list_nationalite_ete)</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>top_nationalites_ete <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(Total <span class="sc">~</span> Nationalite, <span class="at">data =</span> top_nationalites_ete, sum)</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>top_3_nationalites_ete <span class="ot">&lt;-</span> <span class="fu">head</span>(top_nationalites_ete[<span class="fu">order</span>(top_nationalites_ete<span class="sc">$</span>Total, <span class="at">decreasing =</span> <span class="cn">TRUE</span>), ], <span class="dv">3</span>)</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(top_3_nationalites_ete)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Nationalite</th>
<th style="text-align: right;">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">21</td>
<td style="text-align: left;">USA</td>
<td style="text-align: right;">21</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: left;">CHN</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4</td>
<td style="text-align: left;">CUB</td>
<td style="text-align: right;">8</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Ainsi, nous apprenons que les nationalités les plus présentes sont les États-Unis avec 21 athlètes médaillés d’or, suivis par la Chine avec 13, et enfin Cuba avec 8 athlètes médaillés d’or.</p>
</section>
<section id="médaillés-des-jeux-olympiques-dhiver" class="level2">
<h2 class="anchored" data-anchor-id="médaillés-des-jeux-olympiques-dhiver">Médaillés des jeux olympiques d’hiver</h2>
<p>Cette fois, nous travaillerons sur les médaillés des Jeux Olympiques d’hiver. De la même manière, nous préparons notre base de données et corrigeons les erreurs possibles.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>sport_hiver <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(list_tables[<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>sport_hiver <span class="ot">&lt;-</span> sport_hiver[<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(sport_hiver)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"Discipline"</span>, <span class="st">"Annees"</span>, <span class="st">"Editions"</span>, <span class="st">"Epreuves_2020"</span>, <span class="st">"Or"</span>, <span class="st">"Argent"</span>, <span class="st">"Bronze"</span>, <span class="st">"Total"</span>, <span class="st">"Athletes_medailles"</span>, <span class="st">"Athletes_or"</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>sport_hiver[<span class="fu">c</span>(<span class="st">"Editions"</span>, <span class="st">"Epreuves_2020"</span>, <span class="st">"Or"</span>, <span class="st">"Argent"</span>, <span class="st">"Bronze"</span>, <span class="st">"Total"</span>)] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(sport_hiver[<span class="fu">c</span>(<span class="st">"Editions"</span>, <span class="st">"Epreuves_2020"</span>, <span class="st">"Or"</span>, <span class="st">"Argent"</span>, <span class="st">"Bronze"</span>, <span class="st">"Total"</span>)], as.integer)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(sport_hiver)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   15 obs. of  10 variables:
 $ Discipline        : chr  "Biathlon" "Bobsleigh" "Combiné nordique" "Curling" ...
 $ Annees            : chr  "1924,Depuis 1960" "1924-1956,depuis 1964" "Depuis 1924" "1924,depuis 1998" ...
 $ Editions          : int  16 21 22 4 23 14 24 22 7 22 ...
 $ Epreuves_2020     : int  11 3 3 2 2 4 4 12 8 4 ...
 $ Or                : int  54 39 28 7 24 37 77 152 32 38 ...
 $ Argent            : int  54 37 28 7 24 35 75 155 32 39 ...
 $ Bronze            : int  54 39 28 7 24 36 76 148 32 37 ...
 $ Total             : int  162 115 84 21 72 108 228 455 96 114 ...
 $ Athletes_medailles: chr  "Ole Einar Bjørndalen (NOR) (8-4-1)" "Bogdan Musiol (RDA) (1-5-1)" "Felix Gottwald (AUT) (3-1-3)" "Anna Le Moine (SWE) (2-0-0) Cathrine Lindahl (SWE) (2-0-0) Eva Lund (SWE) (2-0-0) Anette Norberg (SWE) (2-0-0)\"| __truncated__ ...
 $ Athletes_or       : chr  "Ole Einar Bjørndalen (NOR) (8-4-1)" "Kevin Kuske (GER) (4-1-0) André Lange (GER) (4-1-0)" "Samppa Lajunen (FIN) (3-2-0)\n Eric Frenzel (GER) (3-1-2)\n Felix Gottwald (AUT) (3-1-3) Johan Grøttumsbråten ("| __truncated__ "Anna Le Moine (SWE) (2-0-0) Cathrine Lindahl (SWE) (2-0-0) Eva Lund (SWE) (2-0-0) Anette Norberg (SWE) (2-0-0)\"| __truncated__ ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(sport_hiver))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 0%">
<col style="width: 3%">
<col style="width: 6%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 0%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 47%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Discipline</th>
<th style="text-align: left;">Annees</th>
<th style="text-align: right;">Editions</th>
<th style="text-align: right;">Epreuves_2020</th>
<th style="text-align: right;">Or</th>
<th style="text-align: right;">Argent</th>
<th style="text-align: right;">Bronze</th>
<th style="text-align: right;">Total</th>
<th style="text-align: left;">Athletes_medailles</th>
<th style="text-align: left;">Athletes_or</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: left;">Biathlon</td>
<td style="text-align: left;">1924,Depuis 1960</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">54</td>
<td style="text-align: right;">54</td>
<td style="text-align: right;">54</td>
<td style="text-align: right;">162</td>
<td style="text-align: left;">Ole Einar Bjørndalen (NOR) (8-4-1)</td>
<td style="text-align: left;">Ole Einar Bjørndalen (NOR) (8-4-1)</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: left;">Bobsleigh</td>
<td style="text-align: left;">1924-1956,depuis 1964</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">39</td>
<td style="text-align: right;">37</td>
<td style="text-align: right;">39</td>
<td style="text-align: right;">115</td>
<td style="text-align: left;">Bogdan Musiol (RDA) (1-5-1)</td>
<td style="text-align: left;">Kevin Kuske (GER) (4-1-0) André Lange (GER) (4-1-0)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4</td>
<td style="text-align: left;">Combiné nordique</td>
<td style="text-align: left;">Depuis 1924</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">84</td>
<td style="text-align: left;">Felix Gottwald (AUT) (3-1-3)</td>
<td style="text-align: left;">Samppa Lajunen (FIN) (3-2-0)</td>
</tr>
</tbody>
</table>
<p>Eric Frenzel (GER) (3-1-2) Felix Gottwald (AUT) (3-1-3) Johan Grøttumsbråten (NOR) (3-1-2) Thorleif Haug (NOR) (3-0-0) Ulrich Wehling (RDA) (3-0-0) | |5 |Curling |1924,depuis 1998 | 4| 2| 7| 7| 7| 21|Anna Le Moine (SWE) (2-0-0) Cathrine Lindahl (SWE) (2-0-0) Eva Lund (SWE) (2-0-0) Anette Norberg (SWE) (2-0-0) Kaitlyn Lawes (CAN) (2-0-0) John Morris (CAN) (2-0-0) Kevin Martin (CAN) (1-1-0) Torger Nergård (NOR) (1-1-0) Mirjam Ott (SUI) (0-2-0) |Anna Le Moine (SWE) (2-0-0) Cathrine Lindahl (SWE) (2-0-0) Eva Lund (SWE) (2-0-0) Anette Norberg (SWE) (2-0-0) Kaitlyn Lawes (CAN) (2-0-0) John Morris (CAN) (2-0-0) | |6 |Hockey sur glace |Été&nbsp;: 1920Hiver&nbsp;: Depuis 1924[1] | 23| 2| 24| 24| 24| 72|Jayna Hefford (CAN) (4-1-0) Hayley Wickenheiser (CAN) (4-1-0) |Jayna Hefford (CAN) (4-1-0) Hayley Wickenheiser (CAN) (4-1-0) Caroline Ouellette (CAN) (4-0-0) | |7 |Luge |Depuis 1964 | 14| 4| 37| 35| 36| 108|Armin Zöggeler (ITA) (2-1-3) |Natalie Geisenberger (GER) (4-0-1) Tobias Arlt (GER) (4-0-0) Tobias Wendl (GER) (4-0-0) |</p>
</div>
</div>
<p>Nous allons maintenant chercher à appliquer les fonctions calcul_medailles_individuelles et extraire_nationalite_athlete sur la base de données des Jeux Olympiques d’hiver.</p>
<p>De la même manière que pour les Jeux Olympiques d’été, nous appliquons à l’ensemble du jeu de données la fonction calcul_medailles_individuelles, mais cette fois-ci avec la fonction map du package purrr et non plus la fonction lapply. La principale différence entre les deux fonction est que <code>map</code> peut être utilisé avec des structures de données de type liste, vecteur, ou data frame, tandis que <code>lapply</code> est spécifiquement conçu pour les listes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>resultats_medailles_hiver <span class="ot">&lt;-</span> <span class="fu">map</span>(sport_hiver<span class="sc">$</span>Athletes_medailles, calcul_medailles_individuelles)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(resultats_medailles_hiver)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] 13

[[2]]
[1] 7

[[3]]
[1] 7

[[4]]
[1] 2 2 2 2 2 2 2 2 2

[[5]]
[1] 5 5

[[6]]
[1] 6</code></pre>
</div>
</div>
<p>Nous observons qu’il n’y a pas de différence significative entre les deux fonctions.</p>
<p>Maintenant que la fonction est appliquée à l’ensemble de nos données, on peut chercher quels athlètes ont été le plus médaillés pour les Jeux Olympiques d’hiver.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>list_medaille_hiver <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(resultats_medailles_hiver)) {</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  matches <span class="ot">&lt;-</span> <span class="fu">str_match_all</span>(sport_hiver<span class="sc">$</span>Athletes_medailles[i],<span class="st">"([^</span><span class="sc">\\</span><span class="st">(]+</span><span class="sc">\\</span><span class="st">s</span><span class="sc">\\</span><span class="st">([^</span><span class="sc">\\</span><span class="st">)]+</span><span class="sc">\\</span><span class="st">))</span><span class="sc">\\</span><span class="st">s*</span><span class="sc">\\</span><span class="st">((</span><span class="sc">\\</span><span class="st">d+)-(</span><span class="sc">\\</span><span class="st">d+)-(</span><span class="sc">\\</span><span class="st">d+)</span><span class="sc">\\</span><span class="st">)"</span>)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  df<span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Athlete =</span> <span class="fu">trimws</span>(matches[[<span class="dv">1</span>]][,<span class="dv">1</span>]),</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Medailles=</span>resultats_medailles_hiver[[i]]</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>  list_medaille_hiver[[i]]<span class="ot">&lt;-</span>df</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>top_medailles_hiver<span class="ot">&lt;-</span><span class="fu">do.call</span>(rbind,list_medaille_hiver)</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(top_medailles_hiver))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Athlete</th>
<th style="text-align: right;">Medailles</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Ole Einar Bjørndalen (NOR) (8-4-1)</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bogdan Musiol (RDA) (1-5-1)</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Felix Gottwald (AUT) (3-1-3)</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: left;">Anna Le Moine (SWE) (2-0-0)</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cathrine Lindahl (SWE) (2-0-0)</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Eva Lund (SWE) (2-0-0)</td>
<td style="text-align: right;">2</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>top_3_medailles_hiver <span class="ot">&lt;-</span> <span class="fu">head</span>(top_medailles_hiver[<span class="fu">order</span>(top_medailles_hiver<span class="sc">$</span>Medailles, <span class="at">decreasing =</span> <span class="cn">TRUE</span>), ], <span class="dv">3</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(top_3_medailles_hiver)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Athlete</th>
<th style="text-align: right;">Medailles</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Marit Bjørgen (NOR) (8-4-3)</td>
<td style="text-align: right;">15</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ole Einar Bjørndalen (NOR) (8-4-1)</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ireen Wüst (NED) (5-5-1)</td>
<td style="text-align: right;">11</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Nous apprenons ainsi que les 3 athlètes avec le plus de médailles sont Marit Bjørgen avec un total de 15 médailles, suivi de Ole Einar Bjørndalen avec 13 médailles, et pour compléter le tableau, Ireen Wüst avec 11 médailles.</p>
<p>Nous allons à présent appliquer la fonction extraire_nationalite_athletes, mais également avec la fonction map du package purrr et non plus la fonction lapply.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>resultat_nationalite_hiver <span class="ot">&lt;-</span> <span class="fu">map</span>(sport_hiver<span class="sc">$</span>Athletes_or,extraire_nationalite_athlete)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(resultat_nationalite_hiver)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
nationalites
    NOR 
  1   1 

[[2]]
nationalites
    GER 
  2   2 

[[3]]
nationalites
    AUT FIN GER NOR RDA 
  6   1   1   1   2   1 

[[4]]
nationalites
    CAN SWE 
  6   2   4 

[[5]]
nationalites
    CAN 
  3   3 

[[6]]
nationalites
    GER 
  3   3 </code></pre>
</div>
</div>
<p>De la même manière que pour la fonction précédente, nous observons qu’il n’y a pas de différence significative entre les deux fonctions.</p>
<p>Maintenant que la fonction est appliquée à l’ensemble de nos données, on peut chercher quels athlètes ont été le plus médaillés pour les Jeux Olympiques d’hiver.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>list_nationalite_hiver <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(sport_hiver<span class="sc">$</span>Athletes_or)) {</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  matches <span class="ot">&lt;-</span> <span class="fu">str_match_all</span>(sport_hiver<span class="sc">$</span>Athletes_or[i], <span class="st">"</span><span class="sc">\\</span><span class="st">((</span><span class="sc">\\</span><span class="st">w{3})</span><span class="sc">\\</span><span class="st">)"</span>)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  nationalites_hiver <span class="ot">&lt;-</span> matches[[<span class="dv">1</span>]][,<span class="dv">2</span>]</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  total_occurrences <span class="ot">&lt;-</span> <span class="fu">table</span>(nationalites_hiver)</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Nationalite =</span> <span class="fu">names</span>(total_occurrences),</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total =</span> <span class="fu">as.integer</span>(total_occurrences)</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>  list_nationalite_hiver[[i]] <span class="ot">&lt;-</span> df</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>top_nationalites_hiver <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, list_nationalite_hiver)</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>top_nationalites_hiver <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(Total <span class="sc">~</span> Nationalite, <span class="at">data =</span> top_nationalites_hiver, sum)</span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>top_3_nationalites_hiver <span class="ot">&lt;-</span> <span class="fu">head</span>(top_nationalites_hiver[<span class="fu">order</span>(top_nationalites_hiver<span class="sc">$</span>Total, <span class="at">decreasing =</span> <span class="cn">TRUE</span>), ], <span class="dv">3</span>)</span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(top_3_nationalites_hiver)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Nationalite</th>
<th style="text-align: right;">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: left;">CAN</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: left;">7</td>
<td style="text-align: left;">NOR</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">6</td>
<td style="text-align: left;">GER</td>
<td style="text-align: right;">6</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Nous apprenons ainsi que pour les Jeux Olympiques d’hiver, les nationalités les plus présentes pour les médailles d’or sont en premier le Canada avec 8 médaillés, suivis de la Norvège avec 7 et pour finir l’Allemagne avec 6 médaillés d’or.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>